2025-06-04 10:46:12,729 - __main__ - INFO - Starting TradeTracker test...
2025-06-04 10:46:12,730 - src.trade_tracker - INFO - TradeTracker initialized
2025-06-04 10:46:12,730 - src.trade_tracker - INFO - Cleared all trades from tracker
2025-06-04 10:46:12,734 - __main__ - INFO - Connecting to TWS...
2025-06-04 10:46:12,735 - src.tws_connection - INFO - Connecting to TWS at 127.0.0.1:7497
2025-06-04 10:46:12,736 - src.tws_connection - INFO - Connection thread: Connecting to 127.0.0.1:7497 (client ID: 2)
2025-06-04 10:46:15,092 - ibapi.client - INFO - sent startApi
2025-06-04 10:46:15,093 - ibapi.client - INFO - REQUEST startApi {}
2025-06-04 10:46:15,094 - ibapi.client - INFO - SENDING startApi b'\x00\x00\x00\x0871\x002\x002\x00\x00'
2025-06-04 10:46:15,104 - ibapi.client - INFO - REQUEST startApi {}
2025-06-04 10:46:15,105 - ibapi.client - INFO - SENDING startApi b'\x00\x00\x00\x0871\x002\x002\x00\x00'
2025-06-04 10:46:15,105 - src.tws_connection - INFO - Connection thread: Socket connected, starting message loop
2025-06-04 10:46:15,135 - src.tws_connection - INFO - Requesting additional order IDs from TWS
2025-06-04 10:46:15,136 - ibapi.client - INFO - REQUEST reqIds {'numIds': 50}
2025-06-04 10:46:15,136 - ibapi.client - INFO - SENDING reqIds b'\x00\x00\x00\x078\x001\x0050\x00'
2025-06-04 10:46:15,156 - src.order.manager - INFO - OrderManager callbacks set up with TWSConnection
2025-06-04 10:46:15,156 - src.position.tracker - INFO - PositionTracker async initialization completed
2025-06-04 10:46:15,156 - src.rule.linked_order_actions - INFO - LinkedOrderConclusionManager initialized - monitoring for position conclusions
2025-06-04 10:46:15,156 - src.rule.engine - INFO - Rule engine started
2025-06-04 10:46:15,157 - __main__ - INFO - 
================================================================================
2025-06-04 10:46:15,157 - __main__ - INFO - TEST 1: FIRST BUY SIGNAL (should create trade)
2025-06-04 10:46:15,157 - __main__ - INFO - ================================================================================
2025-06-04 10:46:15,158 - __main__ - INFO - Active trades before first signal: 0
2025-06-04 10:46:15,158 - src.trade_tracker - INFO - Started tracking BUY trade for SLV
2025-06-04 10:46:15,159 - ibapi.client - INFO - REQUEST reqMktData {'reqId': 1000, 'contract': 2476868064928: 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, 'genericTickList': '', 'snapshot': False, 'regulatorySnapshot': False, 'mktDataOptions': []}
2025-06-04 10:46:15,159 - ibapi.client - INFO - SENDING reqMktData b'\x00\x00\x0001\x0011\x001000\x000\x00SLV\x00STK\x00\x000.0\x00\x00\x00SMART\x00\x00USD\x00\x00\x000\x00\x000\x000\x00\x00'
2025-06-04 10:46:15,202 - ibapi.wrapper - INFO - ANSWER tickReqParams {'tickerId': 1000, 'minTick': 0.01, 'bboExchange': 'a60001', 'snapshotPermissions': 3}
2025-06-04 10:46:15,202 - ibapi.wrapper - INFO - ANSWER marketDataType {'reqId': 1000, 'marketDataType': 1}
2025-06-04 10:46:15,203 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 1, 'price': 31.39, 'attrib': 2476868065936: CanAutoExecute: 1, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:15,203 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 0, 'size': 289}
2025-06-04 10:46:15,203 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 2, 'price': 31.4, 'attrib': 2476867413776: CanAutoExecute: 1, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:15,203 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 3, 'size': 2383}
2025-06-04 10:46:15,204 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 4, 'price': 31.39, 'attrib': 2476867413776: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:15,204 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 5, 'size': 1}
2025-06-04 10:46:15,204 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 0, 'size': 289}
2025-06-04 10:46:15,204 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 3, 'size': 2383}
2025-06-04 10:46:15,205 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 5, 'size': 1}
2025-06-04 10:46:15,205 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 8, 'size': 76155}
2025-06-04 10:46:15,205 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 6, 'price': 31.43, 'attrib': 2476867254608: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:15,205 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 7, 'price': 31.25, 'attrib': 2476867254608: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:15,205 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 9, 'price': 31.44, 'attrib': 2476867092016: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:15,206 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 14, 'price': 31.32, 'attrib': 2476867961728: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:15,206 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1000, 'tickType': 32, 'value': 'KPTVU'}
2025-06-04 10:46:15,206 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1000, 'tickType': 33, 'value': 'ABCNJKPTVYZUH'}
2025-06-04 10:46:15,206 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1000, 'tickType': 84, 'value': 'Z'}
2025-06-04 10:46:15,206 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1000, 'tickType': 45, 'value': '1749048367'}
2025-06-04 10:46:15,207 - ibapi.wrapper - INFO - ANSWER tickGeneric {'reqId': 1000, 'tickType': 49, 'value': 0.0}
2025-06-04 10:46:15,289 - ibapi.wrapper - INFO - ANSWER tickGeneric {'reqId': 1000, 'tickType': 49, 'value': 0.0}
2025-06-04 10:46:16,032 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 0, 'size': 490}
2025-06-04 10:46:16,033 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 3, 'size': 1652}
2025-06-04 10:46:16,033 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1000, 'tickType': 32, 'value': 'NJKPTVZUH'}
2025-06-04 10:46:16,168 - ibapi.client - INFO - REQUEST cancelMktData {'reqId': 1000}
2025-06-04 10:46:16,169 - ibapi.client - INFO - SENDING cancelMktData b'\x00\x00\x00\t2\x002\x001000\x00'
2025-06-04 10:46:16,170 - src.position.sizer - INFO - BUY position size: 95 shares @ $31.39 = $2982.05 (99.4% of $3000.00 allocation)
2025-06-04 10:46:16,170 - src.order.base - INFO - Order 8eaea761-66ca-4d00-8b82-44b343374c58 status changed: created -> pending_submit (Submitting to broker)
2025-06-04 10:46:16,171 - src.order.manager - INFO - Submitting order 8eaea761-66ca-4d00-8b82-44b343374c58 to TWS
2025-06-04 10:46:16,171 - src.order.manager - INFO - Got broker order ID 55 for order 8eaea761-66ca-4d00-8b82-44b343374c58
2025-06-04 10:46:16,171 - src.order.manager - INFO - Calling placeOrder with ID 55, contract 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, order 0,0,0: MKT BUY 95@0.000000 DAY
2025-06-04 10:46:16,171 - ibapi.client - INFO - REQUEST placeOrder {'orderId': 55, 'contract': 2476867414416: 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, 'order': 2476868065936: 0,0,0: MKT BUY 95@0.000000 DAY}
2025-06-04 10:46:16,172 - ibapi.client - INFO - SENDING placeOrder b'\x00\x00\x01:3\x0055\x000\x00SLV\x00STK\x00\x000.0\x00\x00\x00SMART\x00\x00USD\x00\x00\x00\x00\x00BUY\x0095\x00MKT\x000\x000\x00DAY\x00\x00\x00\x000\x00\x001\x000\x000\x000\x000\x000\x000\x000\x00\x000\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00-1\x000\x00\x00\x000\x00\x00\x000\x000\x00\x000\x00\x00\x00\x00\x00\x000\x00\x00\x00\x00\x000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00\x000\x000\x00\x00\x000\x00\x000\x000\x000\x000\x00\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x000\x00\x00\x00\x001.7976931348623157e+308\x00\x00\x00\x00\x000\x000\x000\x00\x00'
2025-06-04 10:46:16,172 - src.order.manager - INFO - placeOrder called successfully for order 8eaea761-66ca-4d00-8b82-44b343374c58
2025-06-04 10:46:16,173 - src.order.base - INFO - Order 8eaea761-66ca-4d00-8b82-44b343374c58 status changed: pending_submit -> submitted (Submitted to broker)
2025-06-04 10:46:16,176 - src.rule.linked_order_actions - INFO - Created new order context for SLV BUY position
2025-06-04 10:46:16,177 - ibapi.client - INFO - REQUEST reqMktData {'reqId': 1001, 'contract': 2476867413776: 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, 'genericTickList': '', 'snapshot': False, 'regulatorySnapshot': False, 'mktDataOptions': []}
2025-06-04 10:46:16,178 - ibapi.client - INFO - SENDING reqMktData b'\x00\x00\x0001\x0011\x001001\x000\x00SLV\x00STK\x00\x000.0\x00\x00\x00SMART\x00\x00USD\x00\x00\x000\x00\x000\x000\x00\x00'
2025-06-04 10:46:16,237 - ibapi.wrapper - INFO - ANSWER tickReqParams {'tickerId': 1001, 'minTick': 0.01, 'bboExchange': 'a60001', 'snapshotPermissions': 3}
2025-06-04 10:46:16,238 - ibapi.wrapper - INFO - ANSWER marketDataType {'reqId': 1001, 'marketDataType': 1}
2025-06-04 10:46:16,238 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 1, 'price': 31.39, 'attrib': 2476867961728: CanAutoExecute: 1, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,238 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 0, 'size': 490}
2025-06-04 10:46:16,238 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 2, 'price': 31.4, 'attrib': 2476867622480: CanAutoExecute: 1, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,239 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 3, 'size': 1652}
2025-06-04 10:46:16,239 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 4, 'price': 31.39, 'attrib': 2476867622480: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,239 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 5, 'size': 1}
2025-06-04 10:46:16,239 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 0, 'size': 490}
2025-06-04 10:46:16,239 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 3, 'size': 1652}
2025-06-04 10:46:16,240 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 5, 'size': 1}
2025-06-04 10:46:16,240 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 8, 'size': 76155}
2025-06-04 10:46:16,243 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 6, 'price': 31.43, 'attrib': 2476867784048: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,244 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 7, 'price': 31.25, 'attrib': 2476867784048: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,245 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 9, 'price': 31.44, 'attrib': 2476867902992: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,245 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 14, 'price': 31.32, 'attrib': 2476867902992: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,245 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1001, 'tickType': 32, 'value': 'NJKPTVZUH'}
2025-06-04 10:46:16,246 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1001, 'tickType': 33, 'value': 'ABCNJKPTVYZUH'}
2025-06-04 10:46:16,247 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1001, 'tickType': 84, 'value': 'Z'}
2025-06-04 10:46:16,247 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1001, 'tickType': 45, 'value': '1749048367'}
2025-06-04 10:46:16,247 - ibapi.wrapper - INFO - ANSWER tickGeneric {'reqId': 1001, 'tickType': 49, 'value': 0.0}
2025-06-04 10:46:16,309 - src.tws_connection - INFO - Open Order - ID: 55, Symbol: SLV, Action: BUY, Quantity: 95.0
2025-06-04 10:46:16,310 - ibapi.client - INFO - REQUEST cancelMktData {'reqId': 1001}
2025-06-04 10:46:16,310 - ibapi.client - INFO - SENDING cancelMktData b'\x00\x00\x00\t2\x002\x001001\x00'
2025-06-04 10:46:16,311 - src.rule.linked_order_actions - INFO - Percentage-based stop: SLV stop at $30.45 (3.0%)
2025-06-04 10:46:16,311 - src.order.base - INFO - Order b685e9cc-f371-409f-90d7-b325ddaef44d status changed: created -> pending_submit (Submitting to broker)
2025-06-04 10:46:16,311 - src.order.manager - INFO - Submitting order b685e9cc-f371-409f-90d7-b325ddaef44d to TWS
2025-06-04 10:46:16,311 - src.order.manager - INFO - Got broker order ID 56 for order b685e9cc-f371-409f-90d7-b325ddaef44d
2025-06-04 10:46:16,312 - src.order.manager - INFO - Calling placeOrder with ID 56, contract 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, order 0,0,0: STP SELL 95@0.000000 DAY
2025-06-04 10:46:16,312 - ibapi.client - INFO - REQUEST placeOrder {'orderId': 56, 'contract': 2476869304704: 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, 'order': 2476867416656: 0,0,0: STP SELL 95@0.000000 DAY}
2025-06-04 10:46:16,312 - ibapi.client - INFO - SENDING placeOrder b'\x00\x00\x01?3\x0056\x000\x00SLV\x00STK\x00\x000.0\x00\x00\x00SMART\x00\x00USD\x00\x00\x00\x00\x00SELL\x0095\x00STP\x000\x0030.45\x00DAY\x00\x00\x00\x000\x00\x001\x000\x000\x000\x000\x000\x000\x000\x00\x000\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00-1\x000\x00\x00\x000\x00\x00\x000\x000\x00\x000\x00\x00\x00\x00\x00\x000\x00\x00\x00\x00\x000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00\x000\x000\x00\x00\x000\x00\x000\x000\x000\x000\x00\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x000\x00\x00\x00\x001.7976931348623157e+308\x00\x00\x00\x00\x000\x000\x000\x00\x00'
2025-06-04 10:46:16,312 - src.order.manager - INFO - placeOrder called successfully for order b685e9cc-f371-409f-90d7-b325ddaef44d
2025-06-04 10:46:16,313 - src.order.base - INFO - Order b685e9cc-f371-409f-90d7-b325ddaef44d status changed: pending_submit -> submitted (Submitted to broker)
2025-06-04 10:46:16,313 - src.rule.linked_order_actions - INFO - Auto-created BUY stop loss b685e9cc-f371-409f-90d7-b325ddaef44d at $30.45
2025-06-04 10:46:16,313 - src.rule.linked_order_actions - INFO - Percentage-based target: SLV target at $33.27 (6.0%)
2025-06-04 10:46:16,313 - src.order.base - INFO - Order 97bd5d42-0b42-455d-a08b-465fcec4568b status changed: created -> pending_submit (Submitting to broker)
2025-06-04 10:46:16,314 - src.order.manager - INFO - Submitting order 97bd5d42-0b42-455d-a08b-465fcec4568b to TWS
2025-06-04 10:46:16,314 - src.order.manager - INFO - Got broker order ID 57 for order 97bd5d42-0b42-455d-a08b-465fcec4568b
2025-06-04 10:46:16,314 - src.order.manager - INFO - Calling placeOrder with ID 57, contract 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, order 0,0,0: LMT SELL 95@33.270000 DAY
2025-06-04 10:46:16,314 - ibapi.client - INFO - REQUEST placeOrder {'orderId': 57, 'contract': 2476867928432: 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, 'order': 2476867417296: 0,0,0: LMT SELL 95@33.270000 DAY}
2025-06-04 10:46:16,315 - ibapi.client - INFO - SENDING placeOrder b'\x00\x00\x01?3\x0057\x000\x00SLV\x00STK\x00\x000.0\x00\x00\x00SMART\x00\x00USD\x00\x00\x00\x00\x00SELL\x0095\x00LMT\x0033.27\x000\x00DAY\x00\x00\x00\x000\x00\x001\x000\x000\x000\x000\x000\x000\x000\x00\x000\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00-1\x000\x00\x00\x000\x00\x00\x000\x000\x00\x000\x00\x00\x00\x00\x00\x000\x00\x00\x00\x00\x000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00\x000\x000\x00\x00\x000\x00\x000\x000\x000\x000\x00\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x000\x00\x00\x00\x001.7976931348623157e+308\x00\x00\x00\x00\x000\x000\x000\x00\x00'
2025-06-04 10:46:16,315 - src.order.manager - INFO - placeOrder called successfully for order 97bd5d42-0b42-455d-a08b-465fcec4568b
2025-06-04 10:46:16,315 - src.order.base - INFO - Order 97bd5d42-0b42-455d-a08b-465fcec4568b status changed: pending_submit -> submitted (Submitted to broker)
2025-06-04 10:46:16,316 - src.rule.linked_order_actions - INFO - Auto-created BUY take profit 97bd5d42-0b42-455d-a08b-465fcec4568b at $33.27
2025-06-04 10:46:16,316 - src.rule.linked_order_actions - INFO - Starting double down order creation for SLV
2025-06-04 10:46:16,389 - src.tws_connection - INFO - Open Order - ID: 56, Symbol: SLV, Action: SELL, Quantity: 95.0
2025-06-04 10:46:16,390 - src.order.base - INFO - Order b685e9cc-f371-409f-90d7-b325ddaef44d status changed: submitted -> accepted (IB status: PreSubmitted)
2025-06-04 10:46:16,436 - src.order.base - INFO - Order 8eaea761-66ca-4d00-8b82-44b343374c58 status changed: submitted -> filled (Order fully filled)
2025-06-04 10:46:16,437 - src.order.base - INFO - Order 8eaea761-66ca-4d00-8b82-44b343374c58 filled: 95.0 @ 31.4 (95.0/95)
2025-06-04 10:46:16,436 - src.tws_connection - INFO - Open Order - ID: 55, Symbol: SLV, Action: BUY, Quantity: 95.0
2025-06-04 10:46:16,468 - src.tws_connection - INFO - Open Order - ID: 55, Symbol: SLV, Action: BUY, Quantity: 95.0
2025-06-04 10:46:16,468 - ibapi.wrapper - INFO - ANSWER commissionReport {'commissionReport': 2476868066608: ExecId: 00025b49.684058e8.01.01, Commission: 1.003325, Currency: USD, RealizedPnL: , Yield: , YieldRedemptionDate: 0}
2025-06-04 10:46:16,470 - src.tws_connection - INFO - Open Order - ID: 57, Symbol: SLV, Action: SELL, Quantity: 95.0
2025-06-04 10:46:16,830 - src.rule.linked_order_actions - INFO - Found 1 stop orders for SLV: ['b685e9cc-f371-409f-90d7-b325ddaef44d']
2025-06-04 10:46:16,831 - src.rule.linked_order_actions - INFO - Executing double down action for SLV
2025-06-04 10:46:16,831 - ibapi.client - INFO - REQUEST reqMktData {'reqId': 1002, 'contract': 2476867784048: 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, 'genericTickList': '', 'snapshot': False, 'regulatorySnapshot': False, 'mktDataOptions': []}
2025-06-04 10:46:16,832 - ibapi.client - INFO - SENDING reqMktData b'\x00\x00\x0001\x0011\x001002\x000\x00SLV\x00STK\x00\x000.0\x00\x00\x00SMART\x00\x00USD\x00\x00\x000\x00\x000\x000\x00\x00'
2025-06-04 10:46:16,865 - ibapi.wrapper - INFO - ANSWER tickReqParams {'tickerId': 1002, 'minTick': 0.01, 'bboExchange': 'a60001', 'snapshotPermissions': 3}
2025-06-04 10:46:16,865 - ibapi.wrapper - INFO - ANSWER marketDataType {'reqId': 1002, 'marketDataType': 1}
2025-06-04 10:46:16,866 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1002, 'tickType': 1, 'price': 31.39, 'attrib': 2476869291760: CanAutoExecute: 1, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,866 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1002, 'tickType': 0, 'size': 490}
2025-06-04 10:46:16,867 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1002, 'tickType': 2, 'price': 31.4, 'attrib': 2476868343120: CanAutoExecute: 1, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,867 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1002, 'tickType': 3, 'size': 1574}
2025-06-04 10:46:16,867 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1002, 'tickType': 4, 'price': 31.39, 'attrib': 2476868343120: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,868 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1002, 'tickType': 5, 'size': 1}
2025-06-04 10:46:16,868 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1002, 'tickType': 0, 'size': 490}
2025-06-04 10:46:16,868 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1002, 'tickType': 3, 'size': 1574}
2025-06-04 10:46:16,869 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1002, 'tickType': 5, 'size': 1}
2025-06-04 10:46:16,869 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1002, 'tickType': 8, 'size': 76155}
2025-06-04 10:46:16,869 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1002, 'tickType': 6, 'price': 31.43, 'attrib': 2476867466032: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,870 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1002, 'tickType': 7, 'price': 31.25, 'attrib': 2476867466032: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,870 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1002, 'tickType': 9, 'price': 31.44, 'attrib': 2476868050832: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,871 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1002, 'tickType': 14, 'price': 31.32, 'attrib': 2476868050832: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 10:46:16,871 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1002, 'tickType': 32, 'value': 'NJKPTVZUH'}
2025-06-04 10:46:16,871 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1002, 'tickType': 33, 'value': 'ABCNJKPTVYZUH'}
2025-06-04 10:46:16,871 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1002, 'tickType': 84, 'value': 'Z'}
2025-06-04 10:46:16,872 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1002, 'tickType': 45, 'value': '1749048367'}
2025-06-04 10:46:16,872 - ibapi.wrapper - INFO - ANSWER tickGeneric {'reqId': 1002, 'tickType': 49, 'value': 0.0}
2025-06-04 10:46:17,171 - ibapi.client - INFO - REQUEST cancelMktData {'reqId': 1002}
2025-06-04 10:46:17,172 - ibapi.client - INFO - SENDING cancelMktData b'\x00\x00\x00\t2\x002\x001002\x00'
2025-06-04 10:46:17,183 - src.rule.linked_order_actions - INFO - Using ATR-based stop distance for SLV: 0.0814
2025-06-04 10:46:17,184 - src.rule.linked_order_actions - INFO - Double down calc for SLV (BUY): current=$31.39, stop_distance=$0.08, dd_distance=$0.04, dd_price=$31.35, original_qty=95, dd_qty=95
2025-06-04 10:46:17,184 - src.order.base - INFO - Order c43a855e-bd02-493c-a7c7-3b34077dcc78 status changed: created -> pending_submit (Submitting to broker)
2025-06-04 10:46:17,185 - src.order.manager - INFO - Submitting order c43a855e-bd02-493c-a7c7-3b34077dcc78 to TWS
2025-06-04 10:46:17,185 - src.order.manager - INFO - Got broker order ID 58 for order c43a855e-bd02-493c-a7c7-3b34077dcc78
2025-06-04 10:46:17,185 - src.order.manager - INFO - Calling placeOrder with ID 58, contract 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, order 0,0,0: LMT BUY 95@31.350000 DAY
2025-06-04 10:46:17,186 - ibapi.client - INFO - REQUEST placeOrder {'orderId': 58, 'contract': 2476867784048: 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, 'order': 2476867415056: 0,0,0: LMT BUY 95@31.350000 DAY}
2025-06-04 10:46:17,186 - ibapi.client - INFO - SENDING placeOrder b'\x00\x00\x01>3\x0058\x000\x00SLV\x00STK\x00\x000.0\x00\x00\x00SMART\x00\x00USD\x00\x00\x00\x00\x00BUY\x0095\x00LMT\x0031.35\x000\x00DAY\x00\x00\x00\x000\x00\x001\x000\x000\x000\x000\x000\x000\x000\x00\x000\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00-1\x000\x00\x00\x000\x00\x00\x000\x000\x00\x000\x00\x00\x00\x00\x00\x000\x00\x00\x00\x00\x000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00\x000\x000\x00\x00\x000\x00\x000\x000\x000\x000\x00\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x000\x00\x00\x00\x001.7976931348623157e+308\x00\x00\x00\x00\x000\x000\x000\x00\x00'
2025-06-04 10:46:17,187 - src.order.manager - INFO - placeOrder called successfully for order c43a855e-bd02-493c-a7c7-3b34077dcc78
2025-06-04 10:46:17,187 - src.order.base - INFO - Order c43a855e-bd02-493c-a7c7-3b34077dcc78 status changed: pending_submit -> submitted (Submitted to broker)
2025-06-04 10:46:17,188 - src.rule.linked_order_actions - INFO - Created BUY double down order 'doubledown1' for SLV: 95 shares @ $31.35
2025-06-04 10:46:17,188 - src.rule.linked_order_actions - INFO - Auto-created double down order for SLV
2025-06-04 10:46:17,188 - src.rule.linked_order_actions - INFO - Created and linked BUY main order 8eaea761-66ca-4d00-8b82-44b343374c58 for SLV
2025-06-04 10:46:17,189 - __main__ - INFO - Active trades after first signal: 1
2025-06-04 10:46:17,194 - __main__ - INFO - Active orders: 3
2025-06-04 10:46:17,194 - __main__ - INFO - 
================================================================================
2025-06-04 10:46:17,194 - __main__ - INFO - TEST 2: SECOND BUY SIGNAL (should be ignored)
2025-06-04 10:46:17,195 - __main__ - INFO - ================================================================================
2025-06-04 10:46:17,195 - src.rule.linked_order_actions - INFO - Ignoring BUY signal for SLV - already have active BUY trade
2025-06-04 10:46:17,323 - src.tws_connection - INFO - Open Order - ID: 58, Symbol: SLV, Action: BUY, Quantity: 95.0
2025-06-04 10:46:18,206 - src.rule.linked_order_actions - INFO - Ignoring BUY signal for SLV - already have active BUY trade
2025-06-04 10:46:19,213 - __main__ - INFO - Active trades after second signal: 1
2025-06-04 10:46:19,214 - src.rule.engine - INFO - Rule engine stopped
2025-06-04 10:46:19,214 - __main__ - INFO - 
Cleaning up orders...
2025-06-04 10:46:19,214 - src.order.base - INFO - Order 97bd5d42-0b42-455d-a08b-465fcec4568b status changed: submitted -> pending_cancel (Test cleanup)
2025-06-04 10:46:19,215 - src.order.manager - INFO - Cancelling order 97bd5d42-0b42-455d-a08b-465fcec4568b with broker ID 57
2025-06-04 10:46:19,215 - ibapi.client - INFO - REQUEST cancelOrder {'orderId': 57}
2025-06-04 10:46:19,215 - ibapi.client - INFO - SENDING cancelOrder b'\x00\x00\x00\x074\x001\x0057\x00'
2025-06-04 10:46:19,216 - src.order.base - INFO - Order b685e9cc-f371-409f-90d7-b325ddaef44d status changed: accepted -> pending_cancel (Test cleanup)
2025-06-04 10:46:19,216 - src.order.manager - INFO - Cancelling order b685e9cc-f371-409f-90d7-b325ddaef44d with broker ID 56
2025-06-04 10:46:19,217 - ibapi.client - INFO - REQUEST cancelOrder {'orderId': 56}
2025-06-04 10:46:19,217 - ibapi.client - INFO - SENDING cancelOrder b'\x00\x00\x00\x074\x001\x0056\x00'
2025-06-04 10:46:19,217 - src.order.base - INFO - Order c43a855e-bd02-493c-a7c7-3b34077dcc78 status changed: submitted -> pending_cancel (Test cleanup)
2025-06-04 10:46:19,218 - src.order.manager - INFO - Cancelling order c43a855e-bd02-493c-a7c7-3b34077dcc78 with broker ID 58
2025-06-04 10:46:19,219 - ibapi.client - INFO - REQUEST cancelOrder {'orderId': 58}
2025-06-04 10:46:19,219 - ibapi.client - INFO - SENDING cancelOrder b'\x00\x00\x00\x074\x001\x0058\x00'
2025-06-04 10:46:19,220 - src.trade_tracker - INFO - Cleared all trades from tracker
2025-06-04 10:46:19,221 - __main__ - INFO - Disconnecting from TWS...
2025-06-04 10:46:19,221 - src.tws_connection - INFO - Disconnecting from TWS
2025-06-04 10:46:19,222 - ibapi.client - INFO - disconnecting
2025-06-04 10:46:19,423 - src.tws_connection - WARNING - Not connected to TWS
2025-06-04 10:46:19,425 - src.tws_connection - INFO - Connection thread: Message loop ended
