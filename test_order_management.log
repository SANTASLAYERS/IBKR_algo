2025-06-04 11:27:16,608 - __main__ - INFO - Starting order management test...
2025-06-04 11:27:16,609 - src.trade_tracker - INFO - TradeTracker initialized
2025-06-04 11:27:16,609 - src.trade_tracker - INFO - Cleared all trades from tracker
2025-06-04 11:27:16,614 - __main__ - INFO - Connecting to TWS...
2025-06-04 11:27:16,614 - src.tws_connection - INFO - Connecting to TWS at 127.0.0.1:7497
2025-06-04 11:27:16,616 - src.tws_connection - INFO - Connection thread: Connecting to 127.0.0.1:7497 (client ID: 2)
2025-06-04 11:27:19,231 - ibapi.client - INFO - sent startApi
2025-06-04 11:27:19,232 - ibapi.client - INFO - REQUEST startApi {}
2025-06-04 11:27:19,232 - ibapi.client - INFO - SENDING startApi b'\x00\x00\x00\x0871\x002\x002\x00\x00'
2025-06-04 11:27:19,243 - ibapi.client - INFO - REQUEST startApi {}
2025-06-04 11:27:19,243 - ibapi.client - INFO - SENDING startApi b'\x00\x00\x00\x0871\x002\x002\x00\x00'
2025-06-04 11:27:19,244 - src.tws_connection - INFO - Connection thread: Socket connected, starting message loop
2025-06-04 11:27:19,283 - src.tws_connection - INFO - Requesting additional order IDs from TWS
2025-06-04 11:27:19,283 - ibapi.client - INFO - REQUEST reqIds {'numIds': 50}
2025-06-04 11:27:19,283 - ibapi.client - INFO - SENDING reqIds b'\x00\x00\x00\x078\x001\x0050\x00'
2025-06-04 11:27:19,301 - src.order.manager - INFO - OrderManager callbacks set up with TWSConnection
2025-06-04 11:27:19,301 - src.position.tracker - INFO - PositionTracker async initialization completed
2025-06-04 11:27:19,301 - src.rule.linked_order_actions - INFO - LinkedOrderConclusionManager initialized - monitoring for position conclusions
2025-06-04 11:27:19,302 - LinkedDoubleDownFillManager - INFO - LinkedDoubleDownFillManager initialized
2025-06-04 11:27:19,302 - src.rule.engine - INFO - Rule engine started
2025-06-04 11:27:19,302 - __main__ - INFO - 
================================================================================
2025-06-04 11:27:19,302 - __main__ - INFO - TEST 1: CREATE POSITION WITH STOPS AND DOUBLE DOWN
2025-06-04 11:27:19,303 - __main__ - INFO - ================================================================================
2025-06-04 11:27:19,303 - src.trade_tracker - INFO - Started tracking BUY trade for SLV
2025-06-04 11:27:19,303 - src.rule.linked_order_actions - INFO - Using fixed position size: 100 shares for SLV
2025-06-04 11:27:19,304 - src.order.base - INFO - Order e6928ac3-dfc4-4cff-be51-12258ad41723 status changed: created -> pending_submit (Submitting to broker)
2025-06-04 11:27:19,304 - src.order.manager - INFO - Submitting order e6928ac3-dfc4-4cff-be51-12258ad41723 to TWS
2025-06-04 11:27:19,305 - src.order.manager - INFO - Got broker order ID 68 for order e6928ac3-dfc4-4cff-be51-12258ad41723
2025-06-04 11:27:19,305 - src.order.manager - INFO - Calling placeOrder with ID 68, contract 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, order 0,0,0: MKT BUY 100@0.000000 DAY
2025-06-04 11:27:19,305 - ibapi.client - INFO - REQUEST placeOrder {'orderId': 68, 'contract': 1931605023712: 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, 'order': 1931605024048: 0,0,0: MKT BUY 100@0.000000 DAY}
2025-06-04 11:27:19,305 - ibapi.client - INFO - SENDING placeOrder b'\x00\x00\x01;3\x0068\x000\x00SLV\x00STK\x00\x000.0\x00\x00\x00SMART\x00\x00USD\x00\x00\x00\x00\x00BUY\x00100\x00MKT\x000\x000\x00DAY\x00\x00\x00\x000\x00\x001\x000\x000\x000\x000\x000\x000\x000\x00\x000\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00-1\x000\x00\x00\x000\x00\x00\x000\x000\x00\x000\x00\x00\x00\x00\x00\x000\x00\x00\x00\x00\x000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00\x000\x000\x00\x00\x000\x00\x000\x000\x000\x000\x00\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x000\x00\x00\x00\x001.7976931348623157e+308\x00\x00\x00\x00\x000\x000\x000\x00\x00'
2025-06-04 11:27:19,306 - src.order.manager - INFO - placeOrder called successfully for order e6928ac3-dfc4-4cff-be51-12258ad41723
2025-06-04 11:27:19,306 - src.order.base - INFO - Order e6928ac3-dfc4-4cff-be51-12258ad41723 status changed: pending_submit -> submitted (Submitted to broker)
2025-06-04 11:27:19,307 - src.rule.linked_order_actions - INFO - Created new order context for SLV BUY position
2025-06-04 11:27:19,307 - ibapi.client - INFO - REQUEST reqMktData {'reqId': 1000, 'contract': 1931604355152: 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, 'genericTickList': '', 'snapshot': False, 'regulatorySnapshot': False, 'mktDataOptions': []}
2025-06-04 11:27:19,307 - ibapi.client - INFO - SENDING reqMktData b'\x00\x00\x0001\x0011\x001000\x000\x00SLV\x00STK\x00\x000.0\x00\x00\x00SMART\x00\x00USD\x00\x00\x000\x00\x000\x000\x00\x00'
2025-06-04 11:27:19,426 - src.tws_connection - INFO - Open Order - ID: 68, Symbol: SLV, Action: BUY, Quantity: 100.0
2025-06-04 11:27:19,427 - src.order.base - INFO - Order e6928ac3-dfc4-4cff-be51-12258ad41723 status changed: submitted -> accepted (IB status: PreSubmitted)
2025-06-04 11:27:19,429 - src.order.base - INFO - Order e6928ac3-dfc4-4cff-be51-12258ad41723 status changed: accepted -> filled (Order fully filled)
2025-06-04 11:27:19,430 - src.order.base - INFO - Order e6928ac3-dfc4-4cff-be51-12258ad41723 filled: 100.0 @ 31.29 (100.0/100)
2025-06-04 11:27:19,430 - src.tws_connection - INFO - Open Order - ID: 68, Symbol: SLV, Action: BUY, Quantity: 100.0
2025-06-04 11:27:19,431 - src.tws_connection - INFO - Open Order - ID: 68, Symbol: SLV, Action: BUY, Quantity: 100.0
2025-06-04 11:27:19,432 - ibapi.wrapper - INFO - ANSWER commissionReport {'commissionReport': 1931605025056: ExecId: 00025b49.68406d72.01.01, Commission: 1.003500, Currency: USD, RealizedPnL: , Yield: , YieldRedemptionDate: 0}
2025-06-04 11:27:19,441 - ibapi.wrapper - INFO - ANSWER tickReqParams {'tickerId': 1000, 'minTick': 0.01, 'bboExchange': 'a60001', 'snapshotPermissions': 3}
2025-06-04 11:27:19,441 - ibapi.wrapper - INFO - ANSWER marketDataType {'reqId': 1000, 'marketDataType': 1}
2025-06-04 11:27:19,442 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 1, 'price': 31.28, 'attrib': 1931605025056: CanAutoExecute: 1, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:19,442 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 0, 'size': 797}
2025-06-04 11:27:19,443 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 2, 'price': 31.29, 'attrib': 1931604357392: CanAutoExecute: 1, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:19,443 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 3, 'size': 844}
2025-06-04 11:27:19,443 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 4, 'price': 31.28, 'attrib': 1931604357392: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:19,444 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 5, 'size': 3}
2025-06-04 11:27:19,444 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 0, 'size': 797}
2025-06-04 11:27:19,444 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 3, 'size': 844}
2025-06-04 11:27:19,444 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 5, 'size': 3}
2025-06-04 11:27:19,444 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 8, 'size': 104672}
2025-06-04 11:27:19,446 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 6, 'price': 31.43, 'attrib': 1931604310960: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:19,446 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 7, 'price': 31.23, 'attrib': 1931604310960: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:19,447 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 9, 'price': 31.44, 'attrib': 1931604049456: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:19,447 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1000, 'tickType': 14, 'price': 31.32, 'attrib': 1931604885856: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:19,447 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1000, 'tickType': 32, 'value': 'ANJKPTVZUH'}
2025-06-04 11:27:19,448 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1000, 'tickType': 33, 'value': 'ACNJKPTVYZUH'}
2025-06-04 11:27:19,448 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1000, 'tickType': 84, 'value': 'C'}
2025-06-04 11:27:19,448 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1000, 'tickType': 45, 'value': '1749050834'}
2025-06-04 11:27:19,448 - ibapi.wrapper - INFO - ANSWER tickGeneric {'reqId': 1000, 'tickType': 49, 'value': 0.0}
2025-06-04 11:27:19,465 - ibapi.wrapper - INFO - ANSWER tickGeneric {'reqId': 1000, 'tickType': 49, 'value': 0.0}
2025-06-04 11:27:19,971 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1000, 'tickType': 0, 'size': 779}
2025-06-04 11:27:20,309 - ibapi.client - INFO - REQUEST cancelMktData {'reqId': 1000}
2025-06-04 11:27:20,310 - ibapi.client - INFO - SENDING cancelMktData b'\x00\x00\x00\t2\x002\x001000\x00'
2025-06-04 11:27:20,310 - src.rule.linked_order_actions - INFO - Percentage-based stop: SLV stop at $30.34 (3.0%)
2025-06-04 11:27:20,311 - src.order.base - INFO - Order 7580c957-786b-475a-9d6f-53547b9e3cf3 status changed: created -> pending_submit (Submitting to broker)
2025-06-04 11:27:20,311 - src.order.manager - INFO - Submitting order 7580c957-786b-475a-9d6f-53547b9e3cf3 to TWS
2025-06-04 11:27:20,312 - src.order.manager - INFO - Got broker order ID 69 for order 7580c957-786b-475a-9d6f-53547b9e3cf3
2025-06-04 11:27:20,312 - src.order.manager - INFO - Calling placeOrder with ID 69, contract 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, order 0,0,0: STP SELL 100@0.000000 DAY
2025-06-04 11:27:20,312 - ibapi.client - INFO - REQUEST placeOrder {'orderId': 69, 'contract': 1931604886400: 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, 'order': 1931604357712: 0,0,0: STP SELL 100@0.000000 DAY}
2025-06-04 11:27:20,313 - ibapi.client - INFO - SENDING placeOrder b'\x00\x00\x01@3\x0069\x000\x00SLV\x00STK\x00\x000.0\x00\x00\x00SMART\x00\x00USD\x00\x00\x00\x00\x00SELL\x00100\x00STP\x000\x0030.34\x00DAY\x00\x00\x00\x000\x00\x001\x000\x000\x000\x000\x000\x000\x000\x00\x000\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00-1\x000\x00\x00\x000\x00\x00\x000\x000\x00\x000\x00\x00\x00\x00\x00\x000\x00\x00\x00\x00\x000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00\x000\x000\x00\x00\x000\x00\x000\x000\x000\x000\x00\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x000\x00\x00\x00\x001.7976931348623157e+308\x00\x00\x00\x00\x000\x000\x000\x00\x00'
2025-06-04 11:27:20,313 - src.order.manager - INFO - placeOrder called successfully for order 7580c957-786b-475a-9d6f-53547b9e3cf3
2025-06-04 11:27:20,314 - src.order.base - INFO - Order 7580c957-786b-475a-9d6f-53547b9e3cf3 status changed: pending_submit -> submitted (Submitted to broker)
2025-06-04 11:27:20,314 - src.rule.linked_order_actions - INFO - Auto-created BUY stop loss 7580c957-786b-475a-9d6f-53547b9e3cf3 at $30.34
2025-06-04 11:27:20,314 - src.rule.linked_order_actions - INFO - Percentage-based target: SLV target at $33.16 (6.0%)
2025-06-04 11:27:20,315 - src.order.base - INFO - Order 2c848bbe-0935-43ed-9ead-4f4f991e1798 status changed: created -> pending_submit (Submitting to broker)
2025-06-04 11:27:20,315 - src.order.manager - INFO - Submitting order 2c848bbe-0935-43ed-9ead-4f4f991e1798 to TWS
2025-06-04 11:27:20,316 - src.order.manager - INFO - Got broker order ID 70 for order 2c848bbe-0935-43ed-9ead-4f4f991e1798
2025-06-04 11:27:20,316 - src.order.manager - INFO - Calling placeOrder with ID 70, contract 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, order 0,0,0: LMT SELL 100@33.160000 DAY
2025-06-04 11:27:20,316 - ibapi.client - INFO - REQUEST placeOrder {'orderId': 70, 'contract': 1931604886400: 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, 'order': 1931604358352: 0,0,0: LMT SELL 100@33.160000 DAY}
2025-06-04 11:27:20,317 - ibapi.client - INFO - SENDING placeOrder b'\x00\x00\x01@3\x0070\x000\x00SLV\x00STK\x00\x000.0\x00\x00\x00SMART\x00\x00USD\x00\x00\x00\x00\x00SELL\x00100\x00LMT\x0033.16\x000\x00DAY\x00\x00\x00\x000\x00\x001\x000\x000\x000\x000\x000\x000\x000\x00\x000\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00-1\x000\x00\x00\x000\x00\x00\x000\x000\x00\x000\x00\x00\x00\x00\x00\x000\x00\x00\x00\x00\x000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00\x000\x000\x00\x00\x000\x00\x000\x000\x000\x000\x00\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x000\x00\x00\x00\x001.7976931348623157e+308\x00\x00\x00\x00\x000\x000\x000\x00\x00'
2025-06-04 11:27:20,317 - src.order.manager - INFO - placeOrder called successfully for order 2c848bbe-0935-43ed-9ead-4f4f991e1798
2025-06-04 11:27:20,317 - src.order.base - INFO - Order 2c848bbe-0935-43ed-9ead-4f4f991e1798 status changed: pending_submit -> submitted (Submitted to broker)
2025-06-04 11:27:20,318 - src.rule.linked_order_actions - INFO - Auto-created BUY take profit 2c848bbe-0935-43ed-9ead-4f4f991e1798 at $33.16
2025-06-04 11:27:20,318 - src.rule.linked_order_actions - INFO - Starting double down order creation for SLV
2025-06-04 11:27:20,391 - src.tws_connection - INFO - Open Order - ID: 69, Symbol: SLV, Action: SELL, Quantity: 100.0
2025-06-04 11:27:20,391 - src.order.base - INFO - Order 7580c957-786b-475a-9d6f-53547b9e3cf3 status changed: submitted -> accepted (IB status: PreSubmitted)
2025-06-04 11:27:20,461 - src.tws_connection - INFO - Open Order - ID: 70, Symbol: SLV, Action: SELL, Quantity: 100.0
2025-06-04 11:27:20,832 - src.rule.linked_order_actions - INFO - Found 1 stop orders for SLV: ['7580c957-786b-475a-9d6f-53547b9e3cf3']
2025-06-04 11:27:20,833 - src.rule.linked_order_actions - INFO - Executing double down action for SLV
2025-06-04 11:27:20,833 - ibapi.client - INFO - REQUEST reqMktData {'reqId': 1001, 'contract': 1931604774496: 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, 'genericTickList': '', 'snapshot': False, 'regulatorySnapshot': False, 'mktDataOptions': []}
2025-06-04 11:27:20,833 - ibapi.client - INFO - SENDING reqMktData b'\x00\x00\x0001\x0011\x001001\x000\x00SLV\x00STK\x00\x000.0\x00\x00\x00SMART\x00\x00USD\x00\x00\x000\x00\x000\x000\x00\x00'
2025-06-04 11:27:20,868 - ibapi.wrapper - INFO - ANSWER tickReqParams {'tickerId': 1001, 'minTick': 0.01, 'bboExchange': 'a60001', 'snapshotPermissions': 3}
2025-06-04 11:27:20,873 - ibapi.wrapper - INFO - ANSWER marketDataType {'reqId': 1001, 'marketDataType': 1}
2025-06-04 11:27:20,873 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 1, 'price': 31.28, 'attrib': 1931604886400: CanAutoExecute: 1, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:20,874 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 0, 'size': 779}
2025-06-04 11:27:20,875 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 2, 'price': 31.29, 'attrib': 1931604563536: CanAutoExecute: 1, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:20,875 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 3, 'size': 844}
2025-06-04 11:27:20,875 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 4, 'price': 31.28, 'attrib': 1931604563536: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:20,876 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 5, 'size': 3}
2025-06-04 11:27:20,876 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 0, 'size': 779}
2025-06-04 11:27:20,876 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 3, 'size': 844}
2025-06-04 11:27:20,877 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 5, 'size': 3}
2025-06-04 11:27:20,877 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 8, 'size': 104672}
2025-06-04 11:27:20,877 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 6, 'price': 31.43, 'attrib': 1931604775456: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:20,877 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 7, 'price': 31.23, 'attrib': 1931604775456: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:20,878 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 9, 'price': 31.44, 'attrib': 1931604845392: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:20,878 - ibapi.wrapper - INFO - ANSWER tickPrice {'reqId': 1001, 'tickType': 14, 'price': 31.32, 'attrib': 1931604845392: CanAutoExecute: 0, PastLimit: 0, PreOpen: 0}
2025-06-04 11:27:20,879 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1001, 'tickType': 32, 'value': 'ANJKPTVZUH'}
2025-06-04 11:27:20,879 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1001, 'tickType': 33, 'value': 'ACNJKPTVYZUH'}
2025-06-04 11:27:20,879 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1001, 'tickType': 84, 'value': 'C'}
2025-06-04 11:27:20,880 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1001, 'tickType': 45, 'value': '1749050834'}
2025-06-04 11:27:20,880 - ibapi.wrapper - INFO - ANSWER tickGeneric {'reqId': 1001, 'tickType': 49, 'value': 0.0}
2025-06-04 11:27:20,939 - ibapi.wrapper - INFO - ANSWER tickGeneric {'reqId': 1001, 'tickType': 49, 'value': 0.0}
2025-06-04 11:27:21,696 - ibapi.wrapper - INFO - ANSWER tickSize {'reqId': 1001, 'tickType': 0, 'size': 828}
2025-06-04 11:27:21,698 - ibapi.wrapper - INFO - ANSWER tickString {'reqId': 1001, 'tickType': 32, 'value': 'ANJKPTVZUH'}
2025-06-04 11:27:22,305 - ibapi.client - INFO - REQUEST cancelMktData {'reqId': 1001}
2025-06-04 11:27:22,307 - ibapi.client - INFO - SENDING cancelMktData b'\x00\x00\x00\t2\x002\x001001\x00'
2025-06-04 11:27:22,311 - src.rule.linked_order_actions - INFO - Using ATR-based stop distance for SLV: 0.0814
2025-06-04 11:27:22,311 - src.rule.linked_order_actions - INFO - Double down calc for SLV (BUY): current=$31.28, stop_distance=$0.08, dd_distance=$0.04, dd_price=$31.24, original_qty=100, dd_qty=100
2025-06-04 11:27:22,311 - src.order.base - INFO - Order 079518ca-6473-4c15-aa44-bb9f81c5c03f status changed: created -> pending_submit (Submitting to broker)
2025-06-04 11:27:22,312 - src.order.manager - INFO - Submitting order 079518ca-6473-4c15-aa44-bb9f81c5c03f to TWS
2025-06-04 11:27:22,312 - src.order.manager - INFO - Got broker order ID 71 for order 079518ca-6473-4c15-aa44-bb9f81c5c03f
2025-06-04 11:27:22,312 - src.order.manager - INFO - Calling placeOrder with ID 71, contract 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, order 0,0,0: LMT BUY 100@31.240000 DAY
2025-06-04 11:27:22,312 - ibapi.client - INFO - REQUEST placeOrder {'orderId': 71, 'contract': 1931604774496: 0,SLV,STK,,0.0,,,SMART,,USD,,,False,,combo:, 'order': 1931604356112: 0,0,0: LMT BUY 100@31.240000 DAY}
2025-06-04 11:27:22,312 - ibapi.client - INFO - SENDING placeOrder b'\x00\x00\x01?3\x0071\x000\x00SLV\x00STK\x00\x000.0\x00\x00\x00SMART\x00\x00USD\x00\x00\x00\x00\x00BUY\x00100\x00LMT\x0031.24\x000\x00DAY\x00\x00\x00\x000\x00\x001\x000\x000\x000\x000\x000\x000\x000\x00\x000\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00-1\x000\x00\x00\x000\x00\x00\x000\x000\x00\x000\x00\x00\x00\x00\x00\x000\x00\x00\x00\x00\x000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x000\x00\x00\x000\x000\x00\x00\x000\x00\x000\x000\x000\x000\x00\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x001.7976931348623157e+308\x000\x00\x00\x00\x001.7976931348623157e+308\x00\x00\x00\x00\x000\x000\x000\x00\x00'
2025-06-04 11:27:22,312 - src.order.manager - INFO - placeOrder called successfully for order 079518ca-6473-4c15-aa44-bb9f81c5c03f
2025-06-04 11:27:22,313 - src.order.base - INFO - Order 079518ca-6473-4c15-aa44-bb9f81c5c03f status changed: pending_submit -> submitted (Submitted to broker)
2025-06-04 11:27:22,313 - src.rule.linked_order_actions - INFO - Created BUY double down order 'doubledown1' for SLV: 100 shares @ $31.24
2025-06-04 11:27:22,313 - src.rule.linked_order_actions - INFO - Auto-created double down order for SLV
2025-06-04 11:27:22,313 - src.rule.linked_order_actions - INFO - Created and linked BUY main order e6928ac3-dfc4-4cff-be51-12258ad41723 for SLV
2025-06-04 11:27:22,313 - __main__ - INFO - 
Active orders after entry:
2025-06-04 11:27:22,314 - __main__ - INFO -   Main orders: 0
2025-06-04 11:27:22,314 - __main__ - INFO -   Stop orders: 1
2025-06-04 11:27:22,314 - __main__ - INFO -   Target orders: 1
2025-06-04 11:27:22,314 - __main__ - INFO -   Double down orders: 1
2025-06-04 11:27:22,314 - __main__ - INFO - 
================================================================================
2025-06-04 11:27:22,314 - __main__ - INFO - TEST 2: SIMULATE DOUBLE DOWN FILL
2025-06-04 11:27:22,315 - __main__ - INFO - ================================================================================
2025-06-04 11:27:22,315 - __main__ - INFO - 
Simulating fill of double down order 079518ca-6473-4c15-aa44-bb9f81c5c03f
2025-06-04 11:27:22,315 - __main__ - INFO - Double down: 100 shares @ $31.24
2025-06-04 11:27:22,416 - src.tws_connection - INFO - Open Order - ID: 71, Symbol: SLV, Action: BUY, Quantity: 100.0
2025-06-04 11:27:24,316 - __main__ - INFO - 
Checking for updated orders...
2025-06-04 11:27:24,317 - __main__ - INFO - 
================================================================================
2025-06-04 11:27:24,317 - __main__ - INFO - TEST 3: CLOSE ALL POSITIONS
2025-06-04 11:27:24,320 - __main__ - INFO - ================================================================================
2025-06-04 11:27:24,324 - __main__ - INFO - 
Active orders before closing: 3
2025-06-04 11:27:24,325 - src.trade_tracker - INFO - Closed trade for SLV
2025-06-04 11:27:24,325 - src.rule.linked_order_actions - INFO - Closed all linked orders and position for SLV
2025-06-04 11:27:26,327 - __main__ - INFO - Active SLV orders after closing: 3
2025-06-04 11:27:26,342 - src.rule.engine - INFO - Rule engine stopped
2025-06-04 11:27:26,342 - __main__ - INFO - 
Final cleanup...
2025-06-04 11:27:26,342 - src.order.base - INFO - Order 2c848bbe-0935-43ed-9ead-4f4f991e1798 status changed: submitted -> pending_cancel (Final cleanup)
2025-06-04 11:27:26,343 - src.order.manager - INFO - Cancelling order 2c848bbe-0935-43ed-9ead-4f4f991e1798 with broker ID 70
2025-06-04 11:27:26,343 - ibapi.client - INFO - REQUEST cancelOrder {'orderId': 70}
2025-06-04 11:27:26,344 - ibapi.client - INFO - SENDING cancelOrder b'\x00\x00\x00\x074\x001\x0070\x00'
2025-06-04 11:27:26,344 - src.order.base - INFO - Order 079518ca-6473-4c15-aa44-bb9f81c5c03f status changed: submitted -> pending_cancel (Final cleanup)
2025-06-04 11:27:26,344 - src.order.manager - INFO - Cancelling order 079518ca-6473-4c15-aa44-bb9f81c5c03f with broker ID 71
2025-06-04 11:27:26,345 - ibapi.client - INFO - REQUEST cancelOrder {'orderId': 71}
2025-06-04 11:27:26,345 - ibapi.client - INFO - SENDING cancelOrder b'\x00\x00\x00\x074\x001\x0071\x00'
2025-06-04 11:27:26,346 - src.order.base - INFO - Order 7580c957-786b-475a-9d6f-53547b9e3cf3 status changed: accepted -> pending_cancel (Final cleanup)
2025-06-04 11:27:26,347 - src.order.manager - INFO - Cancelling order 7580c957-786b-475a-9d6f-53547b9e3cf3 with broker ID 69
2025-06-04 11:27:26,349 - ibapi.client - INFO - REQUEST cancelOrder {'orderId': 69}
2025-06-04 11:27:26,350 - ibapi.client - INFO - SENDING cancelOrder b'\x00\x00\x00\x074\x001\x0069\x00'
2025-06-04 11:27:26,366 - src.trade_tracker - INFO - Cleared all trades from tracker
2025-06-04 11:27:26,370 - __main__ - INFO - Disconnecting from TWS...
2025-06-04 11:27:26,372 - src.tws_connection - INFO - Disconnecting from TWS
2025-06-04 11:27:26,373 - ibapi.client - INFO - disconnecting
2025-06-04 11:27:26,527 - src.tws_connection - WARNING - Not connected to TWS
2025-06-04 11:27:26,528 - src.tws_connection - INFO - Connection thread: Message loop ended
